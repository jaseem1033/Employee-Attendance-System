# Render manifest for Employee Attendance System
#
# This manifest defines two services (backend web service and frontend static site)
# and a managed Postgres database. It intentionally does NOT contain secret values.
# After you connect this repo to Render, set the required secrets in the Render
# dashboard (see `README_RENDER.md`).

services:
  - type: web
    name: employee-attendance-backend
    env: node
    region: oregon
    plan: free
    root: backend
    # When `root: backend` is set, commands run inside that directory. Avoid
    # using `cd backend` here because it will try to `cd` into a non-existent
    # nested folder (backend/backend) and fail. Use direct npm commands.
    # Install devDependencies during build so TypeScript type packages
    # (e.g. @types/express, @types/node) are available for `tsc`.
    buildCommand: npm ci --include=dev && npm run build
    startCommand: npm start
    healthCheckPath: /api/health

  - type: static
    name: employee-attendance-frontend
    env: static
    region: oregon
    plan: free
    root: frontend
    # Same pattern: Render will run commands inside `frontend` when
    # `root: frontend` is set, so avoid `cd frontend` here.
    buildCommand: npm ci && npm run build
    # Publish path should be relative to the service root (frontend), so
    # it's just `dist`.
    staticPublishPath: dist

databases:
  - name: attendance-db
    engine: postgres
    plan: starter
    region: oregon

# Notes:
# - Do NOT store secrets in this file. After Render creates the services, set
#   `DATABASE_URL`, `JWT_SECRET`, `VITE_API_URL`, `CLIENT_URL`, and any other
#   required variables in the Render dashboard.
*** End Patch